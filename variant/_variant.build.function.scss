// Modules.
@use '../class';
@use '../list';
@use '../map';
@use '../property';
@use '../selector';
@use '../values';


@use 'class' as v-class;
@use 'indicator';
@use 'property' as v-property;

// Functions.
@use 'variant.append.function' as *;

// Status: TODO:
// The `variant.build()` function.
// @param `$variant`
@mixin build($variant) {
  $rows: ();
  @each $class-property, $middle-attribute-variant in $variant {
    @if type-of($middle-attribute-variant) == map {
      @each $middle, $attribute-variant in $middle-attribute-variant {
        @if type-of($attribute-variant) == map {
          @each $attribute, $variant in $attribute-variant {
            // FEATURE: Variant 4.
            @if type-of($variant) == map {
              // -
              @debug "Variant 4";
              @if type-of($class-property) == map {
                @each $class1, $property-name in $class-property {
                  @include list.each($class1) using($class1) {
                    @if type-of($middle) == map {
                      @each $class2, $property-name1 in $middle {
                        @include list.each($class2) using($class2) {
                          @if type-of($attribute) == map {
                            @each $class3, $property-name2 in $attribute {
                              @include list.each($class3) using($class3) {
                                @each $value-class, $value in $variant {
                                  // @debug $class1, $class2, $class3, $value-class;
                                  // @debug $property-name, $property-name1, $property-name2, $value;

                                  // FEATURE: (((basic1, basic2): (border, outline)): (((y1, y2): (top, bottom)): (((end1, end2): (color, radius)): ((primary, secondary): 1px solid red))))
                                  // FEATURE: Active.
                                  $rows: append(
                                    $rows,
                                    v-class.set($class1, $class2, $class3, $property-name2, $value-class),
                                    v-property.set($property-name, property.name($property-name1, $property-name2), $value), // TODO:
                                  );
                                }
                              }
                            }
                          } @else {
                            @include list.each($attribute) using($attribute) {
                              @each $value-class, $value in $variant {
                                // @debug $class1, $class2, $attribute, $value-class;
                                // @debug $property-name, $property-name1, $attribute, $value;

                                // FEATURE: (((basic1, basic2): (border, outline)): (((y1, y2): (top, bottom)): ((color, radius): ((primary, secondary): 1px solid red))))
                                // FEATURE: Active.
                                $rows: append(
                                  $rows,
                                  v-class.set($class1, $class2, $attribute, $value-class),
                                  v-property.set($property-name, property.name($property-name1, $attribute), $value), // TODO:
                                );
                              }
                            }
                          }
                        }
                      }
                    } @else {
                      @include list.each($middle) using($middle) {
                        @include list.each($attribute) using($attribute) {
                          @each $value-class, $value in $variant {
                            // @debug $class1, $middle, $attribute, $value-class;
                            // @debug $property-name, $middle, $attribute, $value;

                            // FEATURE: ((basic: (border, outline)): ((top, bottom): ((color, radius): (primary: 1px solid red))))
                            // FEATURE: Active.
                            $rows: append(
                              $rows,
                              v-class.set($class1, $middle, $attribute, $value-class),
                              v-property.set($property-name, property.name($middle, $attribute), $value),
                            );
                          }
                        }
                      }

                    }
                  }
                }
              } @else {
                @include list.each($class-property) using($class) {
                  @include list.each($middle) using($middle) {
                    @include list.each($attribute) using($attribute) {
                      @each $value-class, $value in $variant {
                        // @debug $class, $middle, $attribute, $value-class;
                        // @debug $class, $middle, $attribute, $value;

                        // FEATURE: ((border, outline): ((top, bottom): ((color, radius): (primary: 1px solid red))))
                        // FEATURE: ((border, outline): ((top, bottom): ((color, radius): ((primary, secondary): 1px solid red))))

                        // FEATURE: ((border, outline) start: ((start, bottom): ((color, radius): (primary: 1px solid red))))
                        // FEATURE: ((border, outline) start: ((start, bottom): ((color, radius): ((primary, secondary): 1px solid red))))

                        // FEATURE: ((border, outline): ((start, bottom) start: ((color, radius): (primary: 1px solid red))))
                        // FEATURE: ((border, outline): ((start, bottom) start: ((color, radius): ((primary, secondary): 1px solid red))))

                        // FEATURE: ((border, outline): ((start, bottom): ((color, radius) end: (primary: 1px solid red))))
                        // FEATURE: ((border, outline): ((start, bottom): ((color, radius) end: ((primary, secondary): 1px solid red))))

                        // FEATURE: ((border, outline) item1: ((start, bottom) item2: ((color, radius) item3: (primary: 1px solid red))))
                        // FEATURE: ((border, outline) item1: ((start, bottom) item2: ((color, radius) item3: ((primary, secondary): 1px solid red))))

                        // FEATURE: Active.
                        $rows: append(
                          $rows,
                          v-class.set($class, $middle, $attribute, $value-class),
                          v-property.set($class, property.name($middle, $attribute), $value),
                        );
                      }
                    }
                  }
                }
              }

            // FEATURE: Variant 3.
            } @else {
              @debug "Variant 3";

              $value-class: $attribute;
              $value: $variant;
              @if type-of($class-property) == map {
                @each $class, $property-name in $class-property {
                  @include list.each($class) using($class) {
                    @if type-of($middle) == map {
                      @debug "Middle: (class: property)";

                      // FEATURE: ((basic1 basic2: (border, outline)): (top bottom: (primary red: 1px solid red)))
                      // FEATURE: ((basic1: (border, outline)): (((top, bottom): (top, bottom)): ((primary, secondary): 1px solid red)))
                      // FEATURE: (((basic1, basic2): (border, outline)): (((top, bottom): (top, bottom)): ((primary, secondary): 1px solid red)))
                      @each $class1, $property-name1 in $middle {
                        @include list.each($class1) using($class1) {
                          $rows: append(
                            $rows,
                            v-class.set($class, $class1, $value-class),
                            v-property.set($property-name, $property-name1, $value),
                          );
                        }
                      }
                    } @else {
                      @debug "Middle: class + property";

                      // FEATURE: ((basic1: (border, outline)): (top: (primary: 1px solid red)))
                      // FEATURE: ((basic1: (border, outline)): ((top bottom: (top, bottom)): (primary: 1px solid red)))
                      // FEATURE: ((basic1: (border, outline)): (((top, bottom): (top, bottom)): (primary: 1px solid red)))
                      // FEATURE: (((basic1, basic2): (border, outline)): (top bottom: (primary red: 1px solid red, secondary: 2px solid blue)))
                      @include list.each($middle) using($middle) {
                        $rows: append(
                          $rows,
                          v-class.set($class, $middle, $value-class),
                          v-property.set($property-name, $middle, $value),
                        );
                      }
                    }
                  }
                }
              } @else {
                // FEATURE: (border: (top: (primary: 1px solid red)))
                // FEATURE: ((border, outline): (top: (primary: 1px solid red)))
                // FEATURE: ((border, outline): ((top, bottom): (primary: 1px solid red)))
                // FEATURE: ((border, outline): ((top, bottom): ((primary, secondary): 1px solid red)))
                // FEATURE: (border: (top: ((primary, secondary): 1px solid red)))
                // FEATURE: (border: ((top, bottom): ((primary, secondary): 1px solid red)))
                @include list.each($class-property) using($class) {
                  @include list.each($middle) using($middle) {
                    $rows: append(
                      $rows,
                      v-class.set($class, $middle, $value-class),
                      v-property.set($class, $middle, $value),
                    );
                  }
                }
              }
            }
          }

        } @else {
          // FEATURE: Variant 2.
          @debug "Variant 2";

          $value: $attribute-variant;
          @if type-of($class-property) == map {
            @each $class, $property-name in $class-property {
              @include list.each($class) using($class) {
                @include list.each($middle) using($middle) {
                  $rows: append(
                    $rows,
                    v-class.set($class, $middle),
                    v-property.set($property-name, null, $value),
                  );
                }
              }
            }
          } @else {
            @include list.each($class-property) using($class-property) {
              @include list.each($middle) using($middle) {
                $rows: append(
                  $rows,
                  v-class.set($class-property, $middle),
                  v-property.set($class-property, null, $value),
                );
              }
            }
          }
        }
      }

    } @else {
      // FEATURE: Variant 1.
      @debug "Variant 1";

      $value: $middle-attribute-variant;
      @if type-of($class-property) == map {
        @each $class, $property-name in $class-property {
          @include list.each($class) using($class) {
            $rows: append($rows, $class, v-property.set($property-name, null, $value));
          }
        }
      } @else {
        @include list.each($class-property) using($class) {
          $rows: append($rows, $class, v-property.set($class, null, $value));
        }
      }
    }
  }

  // @debug $rows;

  @content($rows);
}




@include build(
  // FEATURE: Variant 1
  // (border: 1px solid red)
  // (border: (top: 1px solid red)) // TODO: add + to property
  // ((basic: border): ((top, bottom): 1px solid red))


) using($resolved) {
  @each $resolved in $resolved {
    @include class.content(map.get($resolved, class)) {
      @include property.set(
        (map.get($resolved, (property, name)): map.get($resolved, (property, value)))
      );
    }
  }
}

// @include class.content((border top, outline bottom)) {
// @include class.content((border (top, bottom) color)) {
//   cursor: crosshair;
// }


// Examples.
// --
// Variant 1
// --
// @include build((border: 1px solid red));
// @include build((border top: 1px solid red));
// @include build(((border, outline): 1px solid red));
// @include build(((border top, outline top): 1px solid red));
// @include build(((border, outline) top: 1px solid red));
// @include build((border: 1px solid red, outline: 2px solid blue));
// @include build((
//   (border, outline): 1px solid red,
//   (border, outline) (top, bottom): 1px solid red,
//   (top, bottom): 1px solid red
// ));


// --
// @include build((((basic 1, basic 2): border): 1px solid red));
// @include build(((basic-1: border, basic-2: border): 1px solid red));


// --
// @include build(((basic: (border, outline)): 1px solid red));
// @include build((((basic1, basic2): (border, outline)): 1px solid red));
// @include build((((basic1, basic2): (border, outline) (top, bottom)): 1px solid red));


// --
// Variant 2
// --
// @include build((border: (top: 1px solid red)));
// @include build((border: ((top, bottom): 1px solid red)));
// @include build(((border, outline): (top: 1px solid red)));
// @include build(((border, outline): ((top, bottom): 1px solid red)));
// @include build(((border, outline) top: (color: 1px solid red)));
// @include build(((border, outline) start: ((start, end) color: 1px solid red))); // TODO:

// @include build(((basic: border): (top: 1px solid red)));
// @include build(((basic: (border, outline)): (top: 1px solid red)));
// @include build((((basic1, basic2): (border, outline)): (top: 1px solid red)));
// @include build(((basic1: border, basic2: border): (top: 1px solid red)));
// @include build(((border, outline): ((top, bottom): 1px solid red, bottom: 2px solid blue)));
// @include build((((basic1, basic2): border, extended: outline): 1px solid red, outline: 2px solid blue));


// --
// Variant 3
// --
// @include build((border: (top: (primary: 1px solid red))));
// @include build(((border, outline): (top: (primary: 1px solid red))));
// @include build((border: ((top, bottom): (primary: 1px solid red))));
// @include build((border: (top: ((primary, secondary): 1px solid red))));

// @include build(((border, outline): ((top, bottom): (primary: 1px solid red))));
// @include build(((border, outline) top: ((color, radius): (primary: 1px solid red))));
// @include build(((border, outline): ((top, bottom): (primary: 1px solid red, secondary: 1px solid red))));
// @include build(((border, outline): ((top, bottom): ((primary, secondary): 1px solid red, (third, fourth): 2px solid blue))));


// @include build((border: (top: (primary: 1px solid red, secondary: 2px solid blue))));
// @include build((border: (top: (primary: 1px solid red))));
// @include build((border: ((top, right): (border: 1px solid red, outline: 2px solid blue))));



// FEATURE: Variant 1
// (border: 1px solid red)
// ((border, outline): 1px solid red)
// (border: 1px solid red, outline: 2px solid blue)

// (border top: 1px solid red)
// ((border color, border top): 1px solid red)

// (border (top, bottom): 1px solid red)
// ((border, outline) top: 1px solid red)
// ((border, outline) '+top': 1px solid red) // TODO:

// (border (top, bottom) color: 1px solid red)
// ((border (top, bottom) color, outline (top, bottom) color): 1px solid red)
// (border (top, bottom) '+color': 1px solid red) // TODO:

// (((basic 1, basic 2): border): 1px solid red)
// ((basic-1: border, basic-2: border): 1px solid red)

// ((basic: (border, outline)): 1px solid red)
// ((basic: (border top, outline bottom)): 1px solid red)
// ((basic: border (top,bottom)): 1px solid red)

// (((basic1, basic2): (border, outline)): 1px solid red)


// FEATURE: Variant 2.
// (border: (top: 1px solid red))
// (border: ((top, bottom) color: 1px solid red))

// ((border, outline): (top: 1px solid red))
// ((border, outline): ((top, bottom): 1px solid red))
// ((border, outline) top: (color: 1px solid red))
// ((border, outline) start: ((start, end) color: 1px solid red))
// ((border, outline) '+top': (color: 1px solid red)) // TODO:

// ((basic: border): (top: 1px solid red))
// ((basic: (border, outline)): (top: 1px solid red))
// (((basic1, basic2): (border, outline)): (top: 1px solid red))
// ((basic1: border, basic2: border): (top: 1px solid red))
// ((border, outline): ((top, bottom): 1px solid red, bottom: 2px solid blue))
// (((basic1, basic2): border, extended: outline): 1px solid red, outline: 2px solid blue)


// FEATURE: Variant 3
// (border: (top: (primary: 1px solid red)))
// ((border, outline): (top: (primary: 1px solid red)))
// ((border, outline): ((top, bottom): (primary: 1px solid red)))
// ((border, outline): ((top, bottom): ((primary, secondary): 1px solid red)))
// (border: (top: ((primary, secondary): 1px solid red)))
// (border: ((top, bottom): ((primary, secondary): 1px solid red)))

// ((basic1: (border, outline)): (top: (primary: 1px solid red)))
// ((basic1 basic2: (border, outline)): (top bottom: (primary red: 1px solid red)))

// ((basic1: (border, outline)): ((top bottom: (top, bottom)): (primary: 1px solid red)))
// ((basic1: (border, outline)): (((top, bottom): (top, bottom)): (primary: 1px solid red)))
// ((basic1: (border, outline)): (((top, bottom): (top, bottom)): ((primary, secondary): 1px solid red)))

// (((basic1, basic2): (border, outline)): (top bottom: (primary red: 1px solid red, secondary: 2px solid blue)))
// (((basic1, basic2): (border, outline)): (((top, bottom): (top, bottom)): ((primary, secondary): 1px solid red)))

// (((basic1, basic2): (border, outline)): (((y1, y2): (top, bottom)): ((primary, secondary): 1px solid red)))


// FEATURE: Variant 4
// ((border, outline): ((top, bottom): ((color, radius): (primary: 1px solid red))))
// ((border, outline): ((top, bottom): ((color, radius): ((primary, secondary): 1px solid red))))

// ((border, outline): ((top, bottom): ((color, radius): (primary: 1px solid red, secondary: 2px solid blue))))

// ((border, outline) start: ((start, bottom): ((color, radius):s (primary: 1px solid red))))
// ((border, outline) start: ((start, bottom): ((color, radius): ((primary, secondary): 1px solid red))))

// ((border, outline): ((start, bottom) start: ((color, radius): (primary: 1px solid red))))
// ((border, outline): ((start, bottom) start: ((color, radius): ((primary, secondary): 1px solid red))))

// ((border, outline): ((start, bottom): ((color, radius) end: (primary: 1px solid red))))
// ((border, outline): ((start, bottom): ((color, radius) end: ((primary, secondary): 1px solid red))))

// ((border, outline) item1: ((start, bottom) item2: ((color, radius) item3: (primary: 1px solid red))))
// ((border, outline) item1: ((start, bottom) item2: ((color, radius) item3: ((primary, secondary): 1px solid red))))

// ((border, outline): ((top, bottom): ((color, radius): ((primary, secondary): 1px solid red))))
// ((border, outline): ((top, bottom): (color: (border: 1px solid red))))
// ((border, outline): ((top, bottom): (color: (primary: 1px solid red))))

// ((basic: (border, outline)): ((top, bottom): ((color, radius): (primary: 1px solid red))))

// (((basic1, basic2): (border, outline)): (((y1, y2): (top, bottom)): ((color, radius): ((primary, secondary): 1px solid red))))
// (((basic1, basic2): (border, outline)): (((y1, y2): (top, bottom)): (((end1, end2): (color, radius)): ((primary, secondary): 1px solid red))))
