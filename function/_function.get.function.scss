// Sass.
@use 'sass:color';
@use 'sass:list';
@use 'sass:map';
@use 'sass:math';
@use 'sass:meta';
@use 'sass:selector';
@use 'sass:string';

// Functions.
@use '../map/get/get.index.function' as map-get-index;
@use 'function.name.function' as function-name;

// Status: DONE
// The `function.get()` function returns `function` named `$name`. The `$name` can be a string `module-function` or `module.function` or
// map `(module: function)`.
// @param `$name` Function name to retrieve.
// @param `$prefix` Function prefixes to search in `$name`.
// @param `$separator` Separator between module and function in string type `$name`.
// @param `$functions` Additional functions of `map` type to get by using `$name`.
// @returns The returned value is an existing `function` or from `$functions` retrieved by using `$name`, `$prefix`, and `$separator`.
@function get($name, $prefix: null, $separator: null, $functions: null) {
  @if list.index(list map string, meta.type-of($name)) {
    // Retrieve name to get function.
    $name: function-name.name($name, $prefix, $separator);

    // First check `$functions`.
    @return if(
      $functions,
      if(
        map.has-key($functions, $name...),
        map.get($functions, $name...),
        map-get-index.index($functions, $name)
      ),
      meta.get-function(
        if(
          list.length($name) == 2,
          list.nth($name, 2) false list.nth($name, 1),
          list.nth($name, 1)
        )...
      )
    );
  }
  @return null;
}

// Alias name for `function.get()`.
@function get-function(
  $name,
  $prefix: null,
  $separator: null,
  $functions: null
) {
  @return get($name, $prefix, $separator, $functions);
}

// Examples.
// $-prefix: ('--', '__', '@', '&', '+', '/');
// $-separator: ('-', '_', '.');

// string
// @debug get(nth); // get-function("nth")
// @debug get(selector-nest); // get-function("nest")

// prefix + string + dot separator
// @debug get('--selector.nest', $-prefix, $-separator); // get-function("nest")
// @debug get('__selector.nest'); // get-function("nest")
// @debug get('@selector.nest'); // get-function("nest")
// @debug get('&selector.nest'); // get-function("nest")
// @debug get('+selector.nest'); // get-function("nest")
// @debug get('/selector.nest'); // get-function("nest")

// prefix + string + dash separator
// @debug get('--selector-nest'); // get-function("nest")
// @debug get(--selector-nest); // get-function("nest")
// @debug get(__selector-nest); // get-function("nest")
// @debug get(+selector-nest); // get-function("nest")
// @debug get(&selector-nest); // get-function("nest")
// @debug get(/selector-nest); // get-function("nest")

// prefix + string + underscore separator
// @debug get('--selector_nest'); // get-function("nest")
// @debug get(--selector_nest); // get-function("nest")
// @debug get(__selector_nest); // get-function("nest")
// @debug get(+selector_nest); // get-function("nest")
// @debug get(&selector_nest); // get-function("nest")
// @debug get(/selector_nest); // get-function("nest")
// @debug get(__list-nth); // get-function("nth")

// prefix + function name
// @debug get('@nth'); // get-function("nth")
// @debug get('/nth'); // get-function("nth")
// @debug get('+nth'); // get-function("nth")

// map
// @debug get((selector: nest)); // get-function("nest")

// map + prefix
// @debug get((--selector: nest)); // get-function("nest")
// @debug get((+selector: nest)); // get-function("nest")
