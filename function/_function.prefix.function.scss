// Sass.
@use 'sass:list';
@use 'sass:meta';

// Modules.
@use '../string';

// Status: DONE
// The `function.prefix()` function gets function prefix of `$prefixes` from `$name`.
// @param `$name` Function name of `list`, `map` or `string` type to get prefix of `$prefix`.
// @param `$prefixes` Prefixes for the function name in `$name`.
// @returns The returned value is prefix of `string` type if found, otherwise `null`.
@function prefix($name, $prefixes: null) {
  @if list.index(list map string, meta.type-of($name)) {
    $name: if(
      list.index(list map, meta.type-of($name)),
      string.join(
        '[SEPARATOR]',
        if(meta.type-of($name) == map, list.nth($name, 1), $name)...
      ),
      $name
    );

    // Split into list.
    @if meta.type-of($name) == string {
      $i: 1;
      @each $index in string.index($name, $prefixes...) {
        @if $index == 1 {
          @return list.nth($prefixes, $i);
        }

        $i: $i + 1;
      }
    }
  }
  @return null;
}

// Alias name for `function.prefix()`.
@function get-prefix($name, $prefixes: null) {
  @return prefix($name, $prefixes);
}

// Alias name for `function.prefix()`.
@function name-prefix($name, $prefixes: null) {
  @return prefix($name, $prefixes);
}

// Examples.
// $prefixes: ('--', '__', '@', '&', '+', '/') !default;
// $separators: ('-', '_', '.') !default;

// string
// @debug prefix(nth, $prefixes); // null
// @debug prefix(color); // null

// prefixed --
// @debug prefix(--selector-nest, $prefixes); // --
// @debug prefix('--selector.nest', $prefixes); // --

// string + `$prefix`
// @debug prefix(--selector-nest, '--'); // --
// @debug prefix('--selector.nest', '--'); // --

// string + different `$prefix`
// @debug prefix(--selector-nest, '@'); // null
// @debug prefix('--selector.nest', '@'); // null

// list
// @debug prefix(list nth); // null
// @debug prefix(selector nest); // null
// @debug prefix(--list nth, $prefixes); // --

// list + `$prefix`
// @debug prefix(--list nth, '--'); // --
// @debug prefix(--selector nest, '--'); // --
// @debug prefix((10xfunction #aaa)); // null

// list + different `$prefix`
// @debug prefix(--selector nest, '@'); // null

// map
// @debug prefix((list: nth)); // null
// @debug prefix((selector: nest)); // null

// map + `$prefix`
// @debug prefix((--list: nth), $prefixes); // --
// @debug prefix((--selector: nest), '--'); // --

// map + different `$prefix`
// @debug prefix((--list: nth), '@'); // null
// @debug prefix((--selector: nest), '@'); // null

// @debug prefix((10xfunction: #aaa)); // null
